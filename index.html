<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/Blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/Blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/Blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/Blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/Blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/Blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/Blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="keywords" content="JAVA, java, Java, spring, boot, mybatis, os">
<meta property="og:type" content="website">
<meta property="og:title" content="HSJ_BLOG">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;">
<meta property="og:site_name" content="HSJ_BLOG">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/Blog/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>HSJ_BLOG</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b50112d6ccfad9033538ee768e32a696";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/Blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">HSJ_BLOG</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/Blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/Blog/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/Blog/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/Blog/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2021/09/06/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2021/09/06/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-09-07T00:05:45+08:00">
                2021-09-07
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2021/09/06/hello-world/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2021/09/06/hello-world/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2021/09/06/mongoDB/%E6%8E%92%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2021/09/06/mongoDB/%E6%8E%92%E5%BA%8F/" itemprop="url">mongoDB/排序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-09-07T00:05:45+08:00">
                2021-09-07
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2021/09/06/mongoDB/%E6%8E%92%E5%BA%8F/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2021/09/06/mongoDB/排序/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2021/08/28/mongoDB/Pipline%E6%9F%A5%E8%AF%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2021/08/28/mongoDB/Pipline%E6%9F%A5%E8%AF%A2/" itemprop="url">MongoDB--Pipline查询</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-08-28T22:29:31+08:00">
                2021-08-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/Blog/categories/MongoDB/" itemprop="url" rel="index">
                    <span itemprop="name">MongoDB</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2021/08/28/mongoDB/Pipline%E6%9F%A5%E8%AF%A2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2021/08/28/mongoDB/Pipline查询/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Pipline-管道-查询"><a href="#Pipline-管道-查询" class="headerlink" title="Pipline(管道) 查询"></a>Pipline(管道) 查询</h1><p>MongoDB通过Pipline(管道)来支持复杂的查询（分组，聚合函数，联表。。。）</p>
<p>Pipline定义了一系列的Stage来处理document，每一个Stage的输入是一个或多个Stage，输出也是一个或多个document，document就像管道里的水一样，从一个Stage流入另一个Stage。</p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.collection.aggregate( [ &#123; &lt;stage&gt; &#125;, ... ] )</span><br></pre></td></tr></table></figure>

<h1 id="Stage"><a href="#Stage" class="headerlink" title="Stage"></a>Stage</h1><h2 id="addFields"><a href="#addFields" class="headerlink" title="$addFields"></a>$addFields</h2><p>添加新的字段到文档中，在MongoDB4.2后更名为$set,并保留$addFields</p>
<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><h4 id="添加新字段或覆盖已存在的字段，支持聚合函数"><a href="#添加新字段或覆盖已存在的字段，支持聚合函数" class="headerlink" title="添加新字段或覆盖已存在的字段，支持聚合函数"></a>添加新字段或覆盖已存在的字段，支持聚合函数</h4><p><code>INPUT</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  _id: 1,</span><br><span class="line">  student: "Maya",</span><br><span class="line">  homework: [ 10, 5, 10 ],</span><br><span class="line">  quiz: [ 10, 8 ],</span><br><span class="line">  extraCredit: 0</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  _id: 2,</span><br><span class="line">  student: "Ryan",</span><br><span class="line">  homework: [ 5, 6, 5 ],</span><br><span class="line">  quiz: [ 8, 8 ],</span><br><span class="line">  extraCredit: 8</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Stage</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">db.scores.aggregate( [</span><br><span class="line">   &#123;</span><br><span class="line">     $addFields: &#123;</span><br><span class="line">       totalHomework: &#123; <span class="attr">$sum</span>: <span class="string">"$homework"</span> &#125; ,</span><br><span class="line">       totalQuiz: &#123; <span class="attr">$sum</span>: <span class="string">"$quiz"</span> &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   &#123;</span><br><span class="line">     $addFields: &#123; <span class="attr">totalScore</span>:</span><br><span class="line">       &#123; <span class="attr">$add</span>: [ <span class="string">"$totalHomework"</span>, <span class="string">"$totalQuiz"</span>, <span class="string">"$extraCredit"</span> ] &#125; &#125;</span><br><span class="line">   &#125;</span><br><span class="line">] )</span><br></pre></td></tr></table></figure>

<p><code>OUTPUT</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_id"</span> : <span class="number">1</span>,</span><br><span class="line">  <span class="attr">"student"</span> : <span class="string">"Maya"</span>,</span><br><span class="line">  <span class="attr">"homework"</span> : [ <span class="number">10</span>, <span class="number">5</span>, <span class="number">10</span> ],</span><br><span class="line">  <span class="attr">"quiz"</span> : [ <span class="number">10</span>, <span class="number">8</span> ],</span><br><span class="line">  <span class="attr">"extraCredit"</span> : <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"totalHomework"</span> : <span class="number">25</span>,</span><br><span class="line">  <span class="attr">"totalQuiz"</span> : <span class="number">18</span>,</span><br><span class="line">  <span class="attr">"totalScore"</span> : <span class="number">43</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"_id"</span> : <span class="number">2</span>,</span><br><span class="line">  <span class="attr">"student"</span> : <span class="string">"Ryan"</span>,</span><br><span class="line">  <span class="attr">"homework"</span> : [ <span class="number">5</span>, <span class="number">6</span>, <span class="number">5</span> ],</span><br><span class="line">  <span class="attr">"quiz"</span> : [ <span class="number">8</span>, <span class="number">8</span> ],</span><br><span class="line">  <span class="attr">"extraCredit"</span> : <span class="number">8</span>,</span><br><span class="line">  <span class="attr">"totalHomework"</span> : <span class="number">16</span>,</span><br><span class="line">  <span class="attr">"totalQuiz"</span> : <span class="number">16</span>,</span><br><span class="line">  <span class="attr">"totalScore"</span> : <span class="number">40</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="支持向嵌入文档添加新字段"><a href="#支持向嵌入文档添加新字段" class="headerlink" title="支持向嵌入文档添加新字段"></a>支持向嵌入文档添加新字段</h4><p><code>INPUT</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; _id: 1, type: "car", specs: &#123; doors: 4, wheels: 4 &#125; &#125;</span><br><span class="line">&#123; _id: 2, type: "motorcycle", specs: &#123; doors: 0, wheels: 2 &#125; &#125;</span><br><span class="line">&#123; _id: 3, type: "jet ski" &#125;</span><br></pre></td></tr></table></figure>

<p><code>Stage</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.vehicles.aggregate( [</span><br><span class="line">        &#123;</span><br><span class="line">           $addFields: &#123;</span><br><span class="line">              "specs.fuel_type": "unleaded"</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">   ] )</span><br></pre></td></tr></table></figure>

<p><code>OUTPUT</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; _id: 1, type: "car",</span><br><span class="line">   specs: &#123; doors: 4, wheels: 4, fuel_type: "unleaded" &#125; &#125;</span><br><span class="line">&#123; _id: 2, type: "motorcycle",</span><br><span class="line">   specs: &#123; doors: 0, wheels: 2, fuel_type: "unleaded" &#125; &#125;</span><br><span class="line">&#123; _id: 3, type: "jet ski",</span><br><span class="line">   specs: &#123; fuel_type: "unleaded" &#125; &#125;</span><br></pre></td></tr></table></figure>
<h4 id="支持向数组字段添加新元素"><a href="#支持向数组字段添加新元素" class="headerlink" title="支持向数组字段添加新元素"></a>支持向数组字段添加新元素</h4><p><code>INPUT</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; _id: 1, student: "Maya", homework: [ 10, 5, 10 ], quiz: [ 10, 8 ], extraCredit: 0 &#125;</span><br><span class="line">&#123; _id: 2, student: "Ryan", homework: [ 5, 6, 5 ], quiz: [ 8, 8 ], extraCredit: 8 &#125;</span><br></pre></td></tr></table></figure>

<p><code>Stage</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.scores.aggregate([</span><br><span class="line">   &#123; $match: &#123; _id: 1 &#125; &#125;,</span><br><span class="line">   &#123; $addFields: &#123; homework: &#123; $concatArrays: [ "$homework", [ 7 ] ] &#125; &#125; &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p><code>OUTPUT</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">1</span>, <span class="attr">"student"</span> : <span class="string">"Maya"</span>, <span class="attr">"homework"</span> : [ <span class="number">10</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">7</span> ], <span class="attr">"quiz"</span> : [ <span class="number">10</span>, <span class="number">8</span> ], <span class="attr">"extraCredit"</span> : <span class="number">0</span> &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://docs.mongodb.com/manual/reference/operator/aggregation/addFields/" target="_blank" rel="noopener">$addFields</a></p>
</blockquote>
<h2 id="bucket"><a href="#bucket" class="headerlink" title="$bucket"></a>$bucket</h2><p>用于对输入的文档进行分组。<br>根据指定的分组表达式和分组上下界将文档分成不同的bucket。</p>
<h3 id="内存限制"><a href="#内存限制" class="headerlink" title="内存限制"></a>内存限制</h3><p>$bucket Stage内存默认不能超过100M</p>
<p><a href="https://docs.mongodb.com/manual/core/aggregation-pipeline-limits/" target="_blank" rel="noopener">Aggregation Pipeline Limits</a></p>
<h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  $bucket: &#123;</span><br><span class="line">      groupBy: <span class="xml"><span class="tag">&lt;<span class="name">expression</span>&gt;</span>,</span></span><br><span class="line">      boundaries: [ &lt;lowerbound1&gt;, &lt;lowerbound2&gt;, ... ],</span><br><span class="line">      default: &lt;literal&gt;,</span><br><span class="line">      output: &#123;</span><br><span class="line">         &lt;output1&gt;: &#123; &lt;$accumulator expression&gt; &#125;,</span><br><span class="line">         ...</span><br><span class="line">         &lt;outputN&gt;: &#123; &lt;$accumulator expression&gt; &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">字段</th>
<th align="center">类型</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">groupBy</td>
<td align="center">表达式</td>
<td align="center">分组依据，一般直接指定某个字段</td>
</tr>
<tr>
<td align="center">boundaries</td>
<td align="center">数组</td>
<td align="center">每个桶的取值范围,eg:[1,2,3] 表示取值范围为[1,2),[2,3)这两个桶</td>
</tr>
<tr>
<td align="center">default</td>
<td align="center">字符</td>
<td align="center">如果不指定default, 每个输入文档都应该有对应的桶，否则会报错，如果指定了default，则不再boundaries范围的的数据都归到default桶中</td>
</tr>
<tr>
<td align="center">output</td>
<td align="center">document</td>
<td align="center">指定输出的文档</td>
</tr>
</tbody></table>
<h3 id="用法-1"><a href="#用法-1" class="headerlink" title="用法"></a>用法</h3><h4 id="分组并指定上下界"><a href="#分组并指定上下界" class="headerlink" title="分组并指定上下界"></a>分组并指定上下界</h4><p><code>INPUT</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.artists.insertMany([</span><br><span class="line">  &#123; "_id" : 1, "last_name" : "Bernard", "first_name" : "Emil", "year_born" : 1868, "year_died" : 1941, "nationality" : "France" &#125;,</span><br><span class="line">  &#123; "_id" : 2, "last_name" : "Rippl-Ronai", "first_name" : "Joszef", "year_born" : 1861, "year_died" : 1927, "nationality" : "Hungary" &#125;,</span><br><span class="line">  &#123; "_id" : 3, "last_name" : "Ostroumova", "first_name" : "Anna", "year_born" : 1871, "year_died" : 1955, "nationality" : "Russia" &#125;,</span><br><span class="line">  &#123; "_id" : 4, "last_name" : "Van Gogh", "first_name" : "Vincent", "year_born" : 1853, "year_died" : 1890, "nationality" : "Holland" &#125;,</span><br><span class="line">  &#123; "_id" : 5, "last_name" : "Maurer", "first_name" : "Alfred", "year_born" : 1868, "year_died" : 1932, "nationality" : "USA" &#125;,</span><br><span class="line">  &#123; "_id" : 6, "last_name" : "Munch", "first_name" : "Edvard", "year_born" : 1863, "year_died" : 1944, "nationality" : "Norway" &#125;,</span><br><span class="line">  &#123; "_id" : 7, "last_name" : "Redon", "first_name" : "Odilon", "year_born" : 1840, "year_died" : 1916, "nationality" : "France" &#125;,</span><br><span class="line">  &#123; <span class="attr">"_id"</span> : <span class="number">8</span>, <span class="attr">"last_name"</span> : <span class="string">"Diriks"</span>, <span class="attr">"first_name"</span> : <span class="string">"Edvard"</span>, <span class="attr">"year_born"</span> : <span class="number">1855</span>, <span class="attr">"year_died"</span> : <span class="number">1930</span>, <span class="attr">"nationality"</span> : <span class="string">"Norway"</span> &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p><code>Stage</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">db.artists.aggregate( [</span><br><span class="line">  <span class="comment">// First Stage</span></span><br><span class="line">  &#123;</span><br><span class="line">    $bucket: &#123;</span><br><span class="line">      groupBy: <span class="string">"$year_born"</span>,                        <span class="comment">// Field to group by</span></span><br><span class="line">      boundaries: [ <span class="number">1840</span>, <span class="number">1850</span>, <span class="number">1860</span>, <span class="number">1870</span>, <span class="number">1880</span> ], <span class="comment">// Boundaries for the buckets</span></span><br><span class="line">      <span class="keyword">default</span>: <span class="string">"Other"</span>,                             <span class="comment">// Bucket id for documents which do not fall into a bucket</span></span><br><span class="line">      output: &#123;                                     <span class="comment">// Output for each bucket</span></span><br><span class="line">        <span class="string">"count"</span>: &#123; <span class="attr">$sum</span>: <span class="number">1</span> &#125;,</span><br><span class="line">        <span class="string">"artists"</span> :</span><br><span class="line">          &#123;</span><br><span class="line">            $push: &#123;</span><br><span class="line">              <span class="string">"name"</span>: &#123; <span class="attr">$concat</span>: [ <span class="string">"$first_name"</span>, <span class="string">" "</span>, <span class="string">"$last_name"</span>] &#125;,</span><br><span class="line">              <span class="string">"year_born"</span>: <span class="string">"$year_born"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">] )</span><br></pre></td></tr></table></figure>

<p><code>OUTPUT</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">1840</span>, <span class="attr">"count"</span> : <span class="number">1</span>, <span class="attr">"artists"</span> : [ &#123; <span class="attr">"name"</span> : <span class="string">"Odilon Redon"</span>, <span class="attr">"year_born"</span> : <span class="number">1840</span> &#125; ] &#125;</span><br><span class="line"></span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">1850</span>, <span class="attr">"count"</span> : <span class="number">2</span>, <span class="attr">"artists"</span> : [ &#123; <span class="attr">"name"</span> : <span class="string">"Vincent Van Gogh"</span>, <span class="attr">"year_born"</span> : <span class="number">1853</span> &#125;,</span><br><span class="line">                                           &#123; <span class="attr">"name"</span> : <span class="string">"Edvard Diriks"</span>, <span class="attr">"year_born"</span> : <span class="number">1855</span> &#125; ] &#125;</span><br><span class="line"></span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">1860</span>, <span class="attr">"count"</span> : <span class="number">4</span>, <span class="attr">"artists"</span> : [ &#123; <span class="attr">"name"</span> : <span class="string">"Emil Bernard"</span>, <span class="attr">"year_born"</span> : <span class="number">1868</span> &#125;,</span><br><span class="line">                                           &#123; <span class="attr">"name"</span> : <span class="string">"Joszef Rippl-Ronai"</span>, <span class="attr">"year_born"</span> : <span class="number">1861</span> &#125;,</span><br><span class="line">                                           &#123; <span class="attr">"name"</span> : <span class="string">"Alfred Maurer"</span>, <span class="attr">"year_born"</span> : <span class="number">1868</span> &#125;,</span><br><span class="line">                                           &#123; <span class="attr">"name"</span> : <span class="string">"Edvard Munch"</span>, <span class="attr">"year_born"</span> : <span class="number">1863</span> &#125; ] &#125;</span><br><span class="line"></span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">1870</span>, <span class="attr">"count"</span> : <span class="number">1</span>, <span class="attr">"artists"</span> : [ &#123; <span class="attr">"name"</span> : <span class="string">"Anna Ostroumova"</span>, <span class="attr">"year_born"</span> : <span class="number">1871</span> &#125; ] &#125;</span><br></pre></td></tr></table></figure>
<h4 id="结合-facet按多个字段来分桶"><a href="#结合-facet按多个字段来分桶" class="headerlink" title="结合$facet按多个字段来分桶"></a>结合$facet按多个字段来分桶</h4><blockquote>
<p><a href="https://docs.mongodb.com/manual/reference/operator/aggregation/bucket/" target="_blank" rel="noopener">$bucket</a></p>
</blockquote>
<h2 id="bucketAuto（待续）"><a href="#bucketAuto（待续）" class="headerlink" title="$bucketAuto（待续）"></a>$bucketAuto（待续）</h2><blockquote>
<p><a href="https://docs.mongodb.com/manual/reference/operator/aggregation/bucketAuto/" target="_blank" rel="noopener">$bucketAuto</a></p>
</blockquote>
<h2 id="facet"><a href="#facet" class="headerlink" title="$facet"></a>$facet</h2><p>可定义多个子Pipline，将输入document交由各个子Pipline独立处理，并将子pipline输出的document赋予子pipline对应的outputField</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3.4以上版本支持</span><br></pre></td></tr></table></figure>

<h3 id="索引使用"><a href="#索引使用" class="headerlink" title="索引使用"></a>索引使用</h3><p>$facet使用全表扫描，不使用索引</p>
<h3 id="内存限制-1"><a href="#内存限制-1" class="headerlink" title="内存限制"></a>内存限制</h3><p>$facet 的输出文档不能超过16M</p>
<p><a href="https://docs.mongodb.com/manual/core/aggregation-pipeline-limits/" target="_blank" rel="noopener">Aggregation Pipeline Limits</a></p>
<h3 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">$facet</span>:</span><br><span class="line">   &#123;</span><br><span class="line">      &lt;outputField1&gt;: [ &lt;stage1&gt;, &lt;stage2&gt;, ... ],</span><br><span class="line">      &lt;outputField2&gt;: [ &lt;stage1&gt;, &lt;stage2&gt;, ... ],</span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="不能与-facet配合使用的Stage"><a href="#不能与-facet配合使用的Stage" class="headerlink" title="不能与$facet配合使用的Stage"></a>不能与$facet配合使用的Stage</h3><ul>
<li>$collStats</li>
<li>$facet</li>
<li>$geoNear</li>
<li>$indexStats</li>
<li>$out</li>
<li>$merge</li>
<li>$planCacheStats</li>
</ul>
<h3 id="用法-2"><a href="#用法-2" class="headerlink" title="用法"></a>用法</h3><h4 id="指定多个子pipeline且合并输出为一个document"><a href="#指定多个子pipeline且合并输出为一个document" class="headerlink" title="指定多个子pipeline且合并输出为一个document"></a>指定多个子pipeline且合并输出为一个document</h4><p><code>INPUT</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">1</span>, <span class="attr">"title"</span> : <span class="string">"The Pillars of Society"</span>, <span class="attr">"artist"</span> : <span class="string">"Grosz"</span>, <span class="attr">"year"</span> : <span class="number">1926</span>,</span><br><span class="line">  <span class="attr">"price"</span> : NumberDecimal(<span class="string">"199.99"</span>),</span><br><span class="line">  <span class="attr">"tags"</span> : [ <span class="string">"painting"</span>, <span class="string">"satire"</span>, <span class="string">"Expressionism"</span>, <span class="string">"caricature"</span> ] &#125;</span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">2</span>, <span class="attr">"title"</span> : <span class="string">"Melancholy III"</span>, <span class="attr">"artist"</span> : <span class="string">"Munch"</span>, <span class="attr">"year"</span> : <span class="number">1902</span>,</span><br><span class="line">  <span class="attr">"price"</span> : NumberDecimal(<span class="string">"280.00"</span>),</span><br><span class="line">  <span class="attr">"tags"</span> : [ <span class="string">"woodcut"</span>, <span class="string">"Expressionism"</span> ] &#125;</span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">3</span>, <span class="attr">"title"</span> : <span class="string">"Dancer"</span>, <span class="attr">"artist"</span> : <span class="string">"Miro"</span>, <span class="attr">"year"</span> : <span class="number">1925</span>,</span><br><span class="line">  <span class="attr">"price"</span> : NumberDecimal(<span class="string">"76.04"</span>),</span><br><span class="line">  <span class="attr">"tags"</span> : [ <span class="string">"oil"</span>, <span class="string">"Surrealism"</span>, <span class="string">"painting"</span> ] &#125;</span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">4</span>, <span class="attr">"title"</span> : <span class="string">"The Great Wave off Kanagawa"</span>, <span class="attr">"artist"</span> : <span class="string">"Hokusai"</span>,</span><br><span class="line">  <span class="attr">"price"</span> : NumberDecimal(<span class="string">"167.30"</span>),</span><br><span class="line">  <span class="attr">"tags"</span> : [ <span class="string">"woodblock"</span>, <span class="string">"ukiyo-e"</span> ] &#125;</span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">5</span>, <span class="attr">"title"</span> : <span class="string">"The Persistence of Memory"</span>, <span class="attr">"artist"</span> : <span class="string">"Dali"</span>, <span class="attr">"year"</span> : <span class="number">1931</span>,</span><br><span class="line">  <span class="attr">"price"</span> : NumberDecimal(<span class="string">"483.00"</span>),</span><br><span class="line">  <span class="attr">"tags"</span> : [ <span class="string">"Surrealism"</span>, <span class="string">"painting"</span>, <span class="string">"oil"</span> ] &#125;</span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">6</span>, <span class="attr">"title"</span> : <span class="string">"Composition VII"</span>, <span class="attr">"artist"</span> : <span class="string">"Kandinsky"</span>, <span class="attr">"year"</span> : <span class="number">1913</span>,</span><br><span class="line">  <span class="attr">"price"</span> : NumberDecimal(<span class="string">"385.00"</span>),</span><br><span class="line">  <span class="attr">"tags"</span> : [ <span class="string">"oil"</span>, <span class="string">"painting"</span>, <span class="string">"abstract"</span> ] &#125;</span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">7</span>, <span class="attr">"title"</span> : <span class="string">"The Scream"</span>, <span class="attr">"artist"</span> : <span class="string">"Munch"</span>, <span class="attr">"year"</span> : <span class="number">1893</span>,</span><br><span class="line">  <span class="attr">"tags"</span> : [ <span class="string">"Expressionism"</span>, <span class="string">"painting"</span>, <span class="string">"oil"</span> ] &#125;</span><br><span class="line">&#123; <span class="attr">"_id"</span> : <span class="number">8</span>, <span class="attr">"title"</span> : <span class="string">"Blue Flower"</span>, <span class="attr">"artist"</span> : <span class="string">"O'Keefe"</span>, <span class="attr">"year"</span> : <span class="number">1918</span>,</span><br><span class="line">  <span class="attr">"price"</span> : NumberDecimal(<span class="string">"118.42"</span>),</span><br><span class="line">  <span class="attr">"tags"</span> : [ <span class="string">"abstract"</span>, <span class="string">"painting"</span> ] &#125;</span><br></pre></td></tr></table></figure>

<p><code>Stage</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">db.artwork.aggregate( [</span><br><span class="line">  &#123;</span><br><span class="line">    $facet: &#123;</span><br><span class="line">      <span class="string">"categorizedByTags"</span>: [</span><br><span class="line">        &#123; <span class="attr">$unwind</span>: <span class="string">"$tags"</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">$sortByCount</span>: <span class="string">"$tags"</span> &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"categorizedByPrice"</span>: [</span><br><span class="line">        <span class="comment">// Filter out documents without a price e.g., _id: 7</span></span><br><span class="line">        &#123; <span class="attr">$match</span>: &#123; <span class="attr">price</span>: &#123; <span class="attr">$exists</span>: <span class="number">1</span> &#125; &#125; &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          $bucket: &#123;</span><br><span class="line">            groupBy: <span class="string">"$price"</span>,</span><br><span class="line">            boundaries: [  <span class="number">0</span>, <span class="number">150</span>, <span class="number">200</span>, <span class="number">300</span>, <span class="number">400</span> ],</span><br><span class="line">            <span class="keyword">default</span>: <span class="string">"Other"</span>,</span><br><span class="line">            output: &#123;</span><br><span class="line">              <span class="string">"count"</span>: &#123; <span class="attr">$sum</span>: <span class="number">1</span> &#125;,</span><br><span class="line">              <span class="string">"titles"</span>: &#123; <span class="attr">$push</span>: <span class="string">"$title"</span> &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"categorizedByYears(Auto)"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          $bucketAuto: &#123;</span><br><span class="line">            groupBy: <span class="string">"$year"</span>,</span><br><span class="line">            buckets: <span class="number">4</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<p><code>OUTPUT</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"categorizedByYears(Auto)"</span> : [</span><br><span class="line">    <span class="comment">// First bucket includes the document without a year, e.g., _id: 4</span></span><br><span class="line">    &#123; <span class="attr">"_id"</span> : &#123; <span class="attr">"min"</span> : <span class="literal">null</span>, <span class="attr">"max"</span> : <span class="number">1902</span> &#125;, <span class="attr">"count"</span> : <span class="number">2</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : &#123; <span class="attr">"min"</span> : <span class="number">1902</span>, <span class="attr">"max"</span> : <span class="number">1918</span> &#125;, <span class="attr">"count"</span> : <span class="number">2</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : &#123; <span class="attr">"min"</span> : <span class="number">1918</span>, <span class="attr">"max"</span> : <span class="number">1926</span> &#125;, <span class="attr">"count"</span> : <span class="number">2</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : &#123; <span class="attr">"min"</span> : <span class="number">1926</span>, <span class="attr">"max"</span> : <span class="number">1931</span> &#125;, <span class="attr">"count"</span> : <span class="number">2</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"categorizedByPrice"</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"_id"</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">"count"</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">"titles"</span> : [</span><br><span class="line">        <span class="string">"Dancer"</span>,</span><br><span class="line">        <span class="string">"Blue Flower"</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"_id"</span> : <span class="number">150</span>,</span><br><span class="line">      <span class="attr">"count"</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">"titles"</span> : [</span><br><span class="line">        <span class="string">"The Pillars of Society"</span>,</span><br><span class="line">        <span class="string">"The Great Wave off Kanagawa"</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"_id"</span> : <span class="number">200</span>,</span><br><span class="line">      <span class="attr">"count"</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">"titles"</span> : [</span><br><span class="line">        <span class="string">"Melancholy III"</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"_id"</span> : <span class="number">300</span>,</span><br><span class="line">      <span class="attr">"count"</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">"titles"</span> : [</span><br><span class="line">        <span class="string">"Composition VII"</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// Includes document price outside of bucket boundaries, e.g., _id: 5</span></span><br><span class="line">      <span class="attr">"_id"</span> : <span class="string">"Other"</span>,</span><br><span class="line">      <span class="attr">"count"</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">"titles"</span> : [</span><br><span class="line">        <span class="string">"The Persistence of Memory"</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"categorizedByTags"</span> : [</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"painting"</span>, <span class="attr">"count"</span> : <span class="number">6</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"oil"</span>, <span class="attr">"count"</span> : <span class="number">4</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"Expressionism"</span>, <span class="attr">"count"</span> : <span class="number">3</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"Surrealism"</span>, <span class="attr">"count"</span> : <span class="number">2</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"abstract"</span>, <span class="attr">"count"</span> : <span class="number">2</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"woodblock"</span>, <span class="attr">"count"</span> : <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"woodcut"</span>, <span class="attr">"count"</span> : <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"ukiyo-e"</span>, <span class="attr">"count"</span> : <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"satire"</span>, <span class="attr">"count"</span> : <span class="number">1</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"_id"</span> : <span class="string">"caricature"</span>, <span class="attr">"count"</span> : <span class="number">1</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><a href="https://docs.mongodb.com/manual/reference/operator/aggregation/facet/" target="_blank" rel="noopener">$facet</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2020/09/06/java/jvm/%20JAVA%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E5%92%8C%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E5%BC%82%E5%B8%B8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2020/09/06/java/jvm/%20JAVA%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E5%92%8C%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E5%BC%82%E5%B8%B8/" itemprop="url">JVM-JAVA内存区域和内存溢出异常</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-06T20:29:31+08:00">
                2020-09-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/Blog/categories/JVM/" itemprop="url" rel="index">
                    <span itemprop="name">JVM</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2020/09/06/java/jvm/%20JAVA%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E5%92%8C%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E5%BC%82%E5%B8%B8/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2020/09/06/java/jvm/ JAVA内存区域和内存溢出异常/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="JAVA内存区域"><a href="#JAVA内存区域" class="headerlink" title="JAVA内存区域"></a>JAVA内存区域</h2><h3 id="线程私有"><a href="#线程私有" class="headerlink" title="线程私有"></a>线程私有</h3><h4 id="程序计数器（Program-Counter-Register）"><a href="#程序计数器（Program-Counter-Register）" class="headerlink" title="程序计数器（Program Counter Register）"></a>程序计数器（Program Counter Register）</h4><p>定义：当前线程所执行字节码的行号指示器，指向了下一条将要被执行的指令。线程独占</p>
<p>生命周期：与线程相同</p>
<p>PS：</p>
<ol>
<li><p>在Native方法中，计数器值为空。</p>
</li>
<li><p>本区域是Jvm规范中唯一没有指定OutOfMemoryError异常的区域。</p>
</li>
</ol>
<h4 id="JAVA-虚拟机栈（Java-virtual-machine-stacks）"><a href="#JAVA-虚拟机栈（Java-virtual-machine-stacks）" class="headerlink" title="JAVA 虚拟机栈（Java virtual machine stacks）"></a>JAVA 虚拟机栈（Java virtual machine stacks）</h4><p>定义：虚拟机栈是描述方法执行的内存模型，每一个方法对应一个栈帧，方法调用则栈帧入栈，方法返回则栈帧出栈。 线程独占</p>
<p>栈帧：运行方法的基础数据结构-保存了局部变量表，操作数栈，动态链接，方法出口等信息。</p>
<p>局部变量表：存放了编译期可知的各种变量类型-8中基本数据类型，对象引用（Reference）和returnAdress（指向一条字节码的地址）</p>
<p>slot：局部变量表分配内存空间的基本单位，4字节。即Double和Long类型需要两个slot</p>
<p>异常：<br>StackOverFlowError：线程请求栈深超过虚拟机允许栈深时<br>OutOfMemoryError：栈深可动态扩展且无法申请足够内存时</p>
<h4 id="本地方法栈"><a href="#本地方法栈" class="headerlink" title="本地方法栈"></a>本地方法栈</h4><p>定义：用于执行其他语言的方法</p>
<p>SUN HOTSPOT将其与虚拟机栈合二为一，也会抛出相同的异常</p>
<h3 id="线程共享"><a href="#线程共享" class="headerlink" title="线程共享"></a>线程共享</h3><h4 id="JAVA-堆（JAVA-Heap）"><a href="#JAVA-堆（JAVA-Heap）" class="headerlink" title="JAVA 堆（JAVA Heap）"></a>JAVA 堆（JAVA Heap）</h4><p>定义：用于存放几乎所有new出来的对象，线程共享</p>
<p>生命周期：与虚拟机相同</p>
<p>区域细分：<code>JAVA堆</code>是垃圾回收器的主要管理区域，故也称<code>GC堆（Garbage Collected Heap）</code>。从内存回收上看，回收期器GC时基本使用分代收集算法。故<code>JAVA堆</code>可细分为新生代（Eden区，from Surviver区，to Surviver区），老年代。从内存分配上看，<code>JAVA堆</code>可能为线程在堆中划分出线程独立的分配缓冲区（Thread Local Allocation Buffer）</p>
<p>相关参数</p>
<table>
<thead>
<tr>
<th align="center">参数名称</th>
<th>含义</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">-Xms</td>
<td>初始堆大小</td>
<td>物理内存的1/64</td>
<td>默认(MinHeapFreeRatio参数可以调整)空余堆内存小于40%时，JVM就会增大堆直到-Xmx的最大限制.</td>
</tr>
<tr>
<td align="center">-Xmx</td>
<td>最大堆大小</td>
<td>物理内存的1/4</td>
<td>默认(MaxHeapFreeRatio参数可以调整)空余堆内存大于70%时，JVM会减少堆直到 -Xms的最小限制</td>
</tr>
</tbody></table>
<p>异常：<br>OutOfMemoryError：堆内存不足以分配新的对象时抛出</p>
<h4 id="方法区（Method-Area）"><a href="#方法区（Method-Area）" class="headerlink" title="方法区（Method Area）"></a>方法区（Method Area）</h4><p>定义：用于存放代码，类对象，常量和静态变量</p>
<p>方法区与永久代：JVM规范并没有定义永久代的概念，永久代是HOTSPOT分代收集扩展至方法区的结果。</p>
<p>异常：<br>OutOfMemoryError：方法区内存不足以分配是抛出</p>
<h4 id="运行时常量池（Runtime-Constant-Pool）"><a href="#运行时常量池（Runtime-Constant-Pool）" class="headerlink" title="运行时常量池（Runtime Constant Pool）"></a>运行时常量池（Runtime Constant Pool）</h4><p>定义：方法区的一部分，用于保存各种字面量，符号引用（一般也保存直接引用），相比Class对象常量池，它是动态的，可以在运行时写入新内容（如String.intern）</p>
<p>异常：<br>OutOfMemoryError：方法区内存不足以分配是抛出</p>
<h4 id="直接内存（Direct-Memory）"><a href="#直接内存（Direct-Memory）" class="headerlink" title="直接内存（Direct Memory）"></a>直接内存（Direct Memory）</h4><p>定义：也称堆外内存，不受堆大小限制，受物理机资源限制。基于通道（Channel）和缓冲（Buffer）的NIO可直接通过调用Native函数分配直接内存，由一个存储于堆中的DirecByteBuffer对象进行操作。</p>
<p>异常：<br>OutOfMemoryError：直接内存过大导致动态扩展时内存不足</p>
<h2 id="对象访问方式"><a href="#对象访问方式" class="headerlink" title="对象访问方式"></a>对象访问方式</h2><h3 id="句柄访问"><a href="#句柄访问" class="headerlink" title="句柄访问"></a>句柄访问</h3><p>reference类型变量中存储对象的句柄地址，句柄对象存储于句柄池中，句柄对象保存了对象的真实数据（堆中）和类型信息（方法区）。<br>好处：当对象被移动（比如垃圾回收），栈变量不用同步更新。</p>
<h4 id="直接指针"><a href="#直接指针" class="headerlink" title="直接指针"></a>直接指针</h4><p>reference类型变量中直接存储堆中对象的地址</p>
<p>好处：减少开销</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2020/06/18/java/thread/basic-concepts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2020/06/18/java/thread/basic-concepts/" itemprop="url">线程的基本属性和使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-06-18T13:58:17+08:00">
                2020-06-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/Blog/categories/JAVA/" itemprop="url" rel="index">
                    <span itemprop="name">JAVA</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2020/06/18/java/thread/basic-concepts/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2020/06/18/java/thread/basic-concepts/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="JAVA中的线程"><a href="#JAVA中的线程" class="headerlink" title="JAVA中的线程"></a>JAVA中的线程</h1><h2 id="创建与启动线程"><a href="#创建与启动线程" class="headerlink" title="创建与启动线程"></a>创建与启动线程</h2><p>JAVA通过Thread表示一个线程，通过两种方法可以创建和启动一个线程</p>
<h3 id="1-继承Thread对象，-重写其Run方法"><a href="#1-继承Thread对象，-重写其Run方法" class="headerlink" title="1. 继承Thread对象， 重写其Run方法"></a>1. 继承Thread对象， 重写其Run方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InheritThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//实现线程执行逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Java类只支持单继承，当类已有父类时可通过实现Runnable来创建线程</p>
<h3 id="2-实现Runnable接口，-实现其Run方法"><a href="#2-实现Runnable接口，-实现其Run方法" class="headerlink" title="2. 实现Runnable接口， 实现其Run方法"></a>2. 实现Runnable接口， 实现其Run方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImplementsRunnable</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//实现线程执行逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-启动线程"><a href="#3-启动线程" class="headerlink" title="3. 启动线程"></a>3. 启动线程</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        InheritThread inheritThread = <span class="keyword">new</span> InheritThread();</span><br><span class="line">        Thread implementsRunnable = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ImplementsRunnable());</span><br><span class="line">        <span class="comment">//调用start启动线程</span></span><br><span class="line">        inheritThread.start();</span><br><span class="line">        implementsRunnable.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>还可以通过线程池的发生来调度线程</p>
</blockquote>
<h2 id="线程的基本属性和方法"><a href="#线程的基本属性和方法" class="headerlink" title="线程的基本属性和方法"></a>线程的基本属性和方法</h2><h3 id="1-ID"><a href="#1-ID" class="headerlink" title="1. ID"></a>1. ID</h3><p>ID是线程的唯一标识，创建线程时自动生成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public long getId()</span><br></pre></td></tr></table></figure>

<h3 id="2-Name"><a href="#2-Name" class="headerlink" title="2. Name"></a>2. Name</h3><p>Name是线程的名称，默认情况下位Thread-{ID}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public final synchronized void setName(String name)</span><br><span class="line">public final String getName()</span><br></pre></td></tr></table></figure>

<h3 id="3-Daemon"><a href="#3-Daemon" class="headerlink" title="3. Daemon"></a>3. Daemon</h3><p>守护线程是其他线程的辅助线程，例如垃圾回收线程。当程序的所以非守护线程死亡时，程序结束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public final void setDaemon(boolean on)</span><br><span class="line">public final boolean isDaemon()</span><br></pre></td></tr></table></figure>

<h3 id="4-Priority"><a href="#4-Priority" class="headerlink" title="4. Priority"></a>4. Priority</h3><p>会被映射到操作系统中的优先级，可能会出现不同优先级但在操作系统中是相同优先级的情况。<br>值为1到10，默认为5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public final void setPriority(int newPriority)</span><br><span class="line">public final int getPriority()</span><br></pre></td></tr></table></figure>

<h3 id="4-isAlive"><a href="#4-isAlive" class="headerlink" title="4. isAlive"></a>4. isAlive</h3><p>判断线程是否结束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public final native boolean isAlive()</span><br></pre></td></tr></table></figure>

<h3 id="5-state"><a href="#5-state" class="headerlink" title="5. state"></a>5. state</h3><p>线程从创建到死亡，整个生命周期中会历经不同的状态</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> State &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 线程对象创建，还没有调用start方法</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        NEW,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 线程处于可执行状态， 正在执行中或等待执行调度</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        RUNNABLE,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 等待获取Synchronized同步代码块锁时处于的状态</span></span><br><span class="line"><span class="comment">         * 当线程调用Wait释放锁，被其他线程notify唤醒后因为还需要重新获取锁，</span></span><br><span class="line"><span class="comment">         * 可能会进入此状态</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        BLOCKED,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 当前线程调用一下方法时：</span></span><br><span class="line"><span class="comment">         *   1. Object.wait</span></span><br><span class="line"><span class="comment">         *   2. Thread.join</span></span><br><span class="line"><span class="comment">         *   3. LockSupport.park</span></span><br><span class="line"><span class="comment">         * 线程处于WAITING状态</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        WAITING,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 当线程调用以下方法并指定等待时间时，处于TIMED_WAITING状态：</span></span><br><span class="line"><span class="comment">         *   1.Thread.sleep</span></span><br><span class="line"><span class="comment">         *   2.Object.wait</span></span><br><span class="line"><span class="comment">         *   3.Thread.join</span></span><br><span class="line"><span class="comment">         *   4.LockSupport.parkNanos</span></span><br><span class="line"><span class="comment">         *   5.LockSupport.parkUntil</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        TIMED_WAITING,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 线程执行结束时状态</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        TERMINATED;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-sleep"><a href="#6-sleep" class="headerlink" title="6. sleep"></a>6. sleep</h3><p>使线程等待一段时间，不释放锁</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public static native void sleep(long millis)</span><br><span class="line">public static void sleep(long millis, int nanos)</span><br></pre></td></tr></table></figure>

<h3 id="6-yield"><a href="#6-yield" class="headerlink" title="6. yield"></a>6. yield</h3><p>向调度器建议可以优先执行其他线程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static native void yield()</span><br></pre></td></tr></table></figure>



          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2020/06/15/java/thread/process-thread/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2020/06/15/java/thread/process-thread/" itemprop="url">Java多线程-进程与线程概述</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-06-15T12:32:45+08:00">
                2020-06-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/Blog/categories/JAVA/" itemprop="url" rel="index">
                    <span itemprop="name">JAVA</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2020/06/15/java/thread/process-thread/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2020/06/15/java/thread/process-thread/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-程序，进程与线程"><a href="#1-程序，进程与线程" class="headerlink" title="1.程序，进程与线程"></a>1.程序，进程与线程</h1><h2 id="1-1-什么是程序"><a href="#1-1-什么是程序" class="headerlink" title="1.1 什么是程序"></a>1.1 什么是程序</h2><p>所谓程序，就是我们日常用编程语言编写创建的文件，如.java, .php, .h等等。<br>这些文件是数据和指令的集合，它们描述了希望计算机用什么样的指令去操作什么样的数据，<br>是静态的。</p>
<blockquote>
<p>程序是数据与指令的集合。</p>
</blockquote>
<h2 id="1-2-什么是进程"><a href="#1-2-什么是进程" class="headerlink" title="1.2 什么是进程"></a>1.2 什么是进程</h2><p>程序是静态的，它放置在磁盘上，想要计算机运行它，需要将其载入内存，然后由<br>cpu读取指令并操作数据。这个过程就是进程。计算机想要运行程序，就需要为其<br>分配内存资源，cpu资源等计算机资源。<br>所以我们说</p>
<blockquote>
<p>进程是程序的一次执行，进程是操作系统资源分配和调度的基本单位</p>
</blockquote>
<h2 id="1-4-单进程的缺点"><a href="#1-4-单进程的缺点" class="headerlink" title="1.4 单进程的缺点"></a>1.4 单进程的缺点</h2><ol>
<li>浪费CPU资源</li>
</ol>
<p>进程在执行过程中，需要CPU来调用指令做运算，运算是需要数据的，数据一般通过<br>IO设备获取，在从IO设备读写数据的过程中，CPU处于空闲状态</p>
<ol start="2">
<li>无法实时响应</li>
</ol>
<p>如果进程A需要执行3个月，进程B需要执行3秒，进程A先执行的话进程B就需要<br>等到3个月后才能完成。</p>
<h2 id="1-3-多进程"><a href="#1-3-多进程" class="headerlink" title="1.3 多进程"></a>1.3 多进程</h2><p>多进程引入了时间片的概念，为每个等待执行的进程分配时间片，时间片用完则<br>运行下一个进程，如果进程需要进行IO者将CPU资源也让渡给其他待执行的进程，<br>这样既提高了cpu的资源利用率又尽可能让执行时间短的进程快速响应，提高了使用<br>体验。</p>
<h2 id="1-5-多进程的缺点"><a href="#1-5-多进程的缺点" class="headerlink" title="1.5 多进程的缺点"></a>1.5 多进程的缺点</h2><p>有的程序很简单，比如只输出了Hello World。有的程序很复杂，比如各种Web服务，<br>可能要运行几年的时间。但操作系统每次分配给进程的时间片很短，只执行了程序的一小部分指令，<br>却需要切换整个进程的上下文环境，这让操作系统在进程管理上耗费了更多的资源，<br>有没有办法减少这种资源上的浪费呢？于是出现了线程。</p>
<h2 id="1-6-线程"><a href="#1-6-线程" class="headerlink" title="1.6 线程"></a>1.6 线程</h2><p>如果说进程是程序的一次执行，那线程就是程序片段的一次执行。<br>有了线程之后，CPU就直接调度执行的线程，所以</p>
<blockquote>
<p>线程是CPU调度和分派的基本单位</p>
</blockquote>
<p>因此</p>
<blockquote>
<p>线程的切换要比进程切换资源消耗少得多</p>
</blockquote>
<blockquote>
<p>线程由进程创建，没有独立的地址空间，它们共享创建它们的进程的内存空间</p>
</blockquote>
<h2 id="1-7-线程安全问题"><a href="#1-7-线程安全问题" class="headerlink" title="1.7 线程安全问题"></a>1.7 线程安全问题</h2><p>线程安全问题一般出现多线程对共享资源的访问上出现的问题。<br>假设有两个线程同时对一个变量访问，会有以下三种情况：</p>
<ol>
<li><p>读读：没有线程安全问题</p>
</li>
<li><p>读写：出现脏读，读线程无法读到最新值，出现数据不一致</p>
</li>
<li><p>写写：出现脏写，两个线程有一个的写操作被覆盖了，也称为丢失更新。</p>
</li>
</ol>
<p>解决：</p>
<ol>
<li><p>不要访问共享变量</p>
</li>
<li><p>设定共享变量不可变，也就是只存在读读的情况</p>
</li>
<li><p>对读写，写写操作做同步</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2020/06/13/mysql/select-limit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2020/06/13/mysql/select-limit/" itemprop="url">MySQL在Select中使用Limit的优化问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-06-13T22:29:31+08:00">
                2020-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/Blog/categories/MySQL%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">MySQL学习笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2020/06/13/mysql/select-limit/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2020/06/13/mysql/select-limit/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在阿里的JAVA开发手册中有这么一句</p>
<p><img src="/Blog/2020/06/13/mysql/select-limit/1.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#建表</span><br><span class="line">CREATE TABLE `movies` (</span><br><span class="line">  `id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `title` varchar(20) DEFAULT NULL,</span><br><span class="line">  `year` int(11) DEFAULT NULL,</span><br><span class="line">  `content` varchar(20) DEFAULT &apos;hxmyt&apos;,</span><br><span class="line">  PRIMARY KEY (`id`),</span><br><span class="line">  KEY `year_index` (`year`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">#创建存储过程，插入百万数据</span><br><span class="line">CREATE DEFINER=`root`@`localhost` PROCEDURE `randomMovies`()</span><br><span class="line">begin</span><br><span class="line">declare i int default 0;</span><br><span class="line">while i &lt;= 1000000 do</span><br><span class="line"> insert into movies(title, year) values(substring(md5(rand()),1,8), floor(1970 + rand() * 50));</span><br><span class="line">set i = i + 1;</span><br><span class="line">end while;</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">#修改存储引擎位MySIAM</span><br><span class="line">ALTER TABLE movies ENGINE=MySIAM;</span><br><span class="line">#调用存储过程出入记录</span><br><span class="line">call randomMovies();</span><br><span class="line">call randomMovies();</span><br><span class="line">call randomMovies();</span><br><span class="line">#修改存储引擎位INNODB</span><br><span class="line">ALTER TABLE movies ENGINE=INNODB;</span><br></pre></td></tr></table></figure>

<p>第一次查询<br><img src="/Blog/2020/06/13/mysql/select-limit/2.png" alt><br>耗时3.2秒</p>
<p>尝试limit优化<br><img src="/Blog/2020/06/13/mysql/select-limit/3.png" alt></p>
<p>速度确实变快了，但出现了两个新的问题</p>
<p>1.第一次查询为什么会变慢？</p>
<p>2.优化后返回的结果集与有优化前不同</p>
<p>猜测问题一：第二次调用使用了缓存</p>
<p>验证：使用SQL_NO_CACHE</p>
<p><img src="/Blog/2020/06/13/mysql/select-limit/4.png" alt><br>没有区别,难道不是缓存的原因？</p>
<p>问题二：explain试一下<br><img src="/Blog/2020/06/13/mysql/select-limit/5.png" alt><br>发现扫描的行数为与总行数不同</p>
<p>查了一下是预估值，那可能是因为索引排序有问题，3000000放在293975后面</p>
<p>尝试下排序</p>
<p><img src="/Blog/2020/06/13/mysql/select-limit/6.png" alt></p>
<p>排序后要3秒之久</p>
<p>更换排序条件为year<br><img src="/Blog/2020/06/13/mysql/select-limit/7.png" alt></p>
<p>速度很快，而且结果和不加排序居然一样，才发现两道查询都默认使用了year为索引<br><img src="/Blog/2020/06/13/mysql/select-limit/9.png" alt><br>当使用主键索引的时候速度会变慢</p>
<p>猜测：都产生了覆盖索引，但是主键叶子节点就是行数据，加载起来会非常慢，<br>辅组索引叶子节点是主键，加载更快。</p>
<p>验证方式：待定</p>
<p>尝试了下profile和查询表状态<br><img src="/Blog/2020/06/13/mysql/select-limit/10.png" alt><br><img src="/Blog/2020/06/13/mysql/select-limit/11.png" alt><br>发现时间都花在send data上，而且产生了极多的内存碎片</p>
<p>尝试了下optimize table 和alter table movies engine=innodb<br>都优化不掉内存碎片</p>
<p>未解决问题： </p>
<ul>
<li>第一次查询慢，第二次查询快到底是不是缓存问题？</li>
<li>如何验证主键叶子节点加载时会载入所有数据</li>
<li>send data包含加载数据的时间吗?</li>
<li>为什么会出现这么多内存碎片，如何优化？</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2020/06/13/algorithm/%E5%A4%A7%E9%A1%B6%E5%A0%86%E5%92%8C%E5%B0%8F%E9%A1%B6%E5%A0%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2020/06/13/algorithm/%E5%A4%A7%E9%A1%B6%E5%A0%86%E5%92%8C%E5%B0%8F%E9%A1%B6%E5%A0%86/" itemprop="url">大顶堆和小顶堆</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-06-13T22:29:31+08:00">
                2020-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/Blog/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2020/06/13/algorithm/%E5%A4%A7%E9%A1%B6%E5%A0%86%E5%92%8C%E5%B0%8F%E9%A1%B6%E5%A0%86/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2020/06/13/algorithm/大顶堆和小顶堆/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="堆是什么"><a href="#堆是什么" class="headerlink" title="堆是什么"></a>堆是什么</h2><p>物理上：一个数组<br>逻辑上：堆(Heap)是一棵完全的二叉树，值存储在树的每一个节点上，且具备偏序关系（简单理解为部分有序）</p>
<p>大顶堆：父节点大于或等于子节点的树<br>小顶堆：父节点小于或等于子节点的树</p>
<h2 id="偏序关系"><a href="#偏序关系" class="headerlink" title="偏序关系"></a>偏序关系</h2><h3 id="完全二叉树"><a href="#完全二叉树" class="headerlink" title="完全二叉树"></a>完全二叉树</h3><p><img src="/Blog/2020/06/13/algorithm/%E5%A4%A7%E9%A1%B6%E5%A0%86%E5%92%8C%E5%B0%8F%E9%A1%B6%E5%A0%86/%E6%97%A0%E5%BA%8F.png" alt title="图1.1"></p>
<p>节点的编号即数组的索引，可得：<br>设最小编号0，最大编号n<br>对任意节点编号k,则<br>父节点编号 p= (k - 1) / 2<br>左子节点编号 l= k * 2 + 1<br>右子节点编号 r= k * 2 + 2</p>
<p>最后一个非叶子节点 f=(n - 1) / 2</p>
<h3 id="构建堆（eg-小顶堆）"><a href="#构建堆（eg-小顶堆）" class="headerlink" title="构建堆（eg: 小顶堆）"></a>构建堆（eg: 小顶堆）</h3><p>需要进行堆操作时，我们可能要面临三种情况<br>对于一个无序的数组，我们需要</p>
<ol>
<li>将一个无序数组调整为堆</li>
</ol>
<p>对于一个堆，我们可能对其：</p>
<ol>
<li>添加一个元素到堆中</li>
<li>从堆中删除一个元素</li>
</ol>
<h4 id="将一个无序数组调整为堆"><a href="#将一个无序数组调整为堆" class="headerlink" title="将一个无序数组调整为堆"></a>将一个无序数组调整为堆</h4><p>步骤</p>
<ol>
<li>找到最后一个非叶子节点r</li>
<li>使k = r</li>
<li>k &lt;= f继续，否则执行6</li>
<li>如果k比左右子节点都小，则执行6。否则，与左右子节点中最小的那个交换值</li>
<li>重复2-4步骤</li>
<li>r = r - 1</li>
<li>重复2-6步骤, 直到r &lt; 0</li>
</ol>
<p>以上步骤可分为两部分操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 从后往前遍历所有非叶子节点，即步骤1-7</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = findLastNonLeaf(); i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">            siftDown(i, elements(i));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 对当前非叶子节点做下沉操作，使以当前非叶子节点为</span></span><br><span class="line"><span class="comment">* 根节点的树调整小顶堆,即步骤3-5</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">siftDown</span><span class="params">(<span class="keyword">int</span> k,E e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> lastNonLeaf = findLastNonLeaf();</span><br><span class="line">        <span class="keyword">while</span> (k &lt;= lastNonLeaf) &#123;</span><br><span class="line">            <span class="keyword">int</span> min = findLeftChild(k);</span><br><span class="line">            E child = elements(min);</span><br><span class="line">            <span class="keyword">int</span> right = min + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (right &lt; size &amp;&amp; child.compareTo(elements(right)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                child = elements(min = right);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (e.compareTo(child) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            elements[k] = child;</span><br><span class="line">            k = min;</span><br><span class="line">        &#125;</span><br><span class="line">        elements[k] = e;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="添加一个元素到堆中"><a href="#添加一个元素到堆中" class="headerlink" title="添加一个元素到堆中"></a>添加一个元素到堆中</h4><p>步骤</p>
<ol>
<li>将新元素添加到堆尾，此时新元素编号k = size - 1</li>
<li>k &gt; 0 继续，否则结束</li>
<li>新元素与父节点比较，大于父节点则结束，小于父节点，则与父节点交换值，此时k = (k - 1) / 2</li>
<li>重复2-3步骤</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 对当前叶子节点做上升操作，即步骤2-4</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>


<h4 id="从堆中删除一个元素"><a href="#从堆中删除一个元素" class="headerlink" title="从堆中删除一个元素"></a>从堆中删除一个元素</h4><p>步骤</p>
<ol>
<li>找到元素对应的编号k 并使start = k</li>
<li>k与队尾元素交换值 </li>
<li>下沉k元素</li>
<li>如果start == k，则对k上升，否则结束</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* k与队尾元素交换后先下沉后上升</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">siftUp</span><span class="params">(<span class="keyword">int</span> k, E e)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> parentIndex = findParent(k);</span><br><span class="line">            E parent = elements(parentIndex);</span><br><span class="line">            <span class="keyword">if</span> (e.compareTo(parent) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            elements[k] = parent;</span><br><span class="line">            k = parentIndex;</span><br><span class="line">        &#125;</span><br><span class="line">        elements[k] = e;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h3><h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2019/12/18/mysql/server-client-communication-way/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2019/12/18/mysql/server-client-communication-way/" itemprop="url">MySQL-server与client的通信方式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-18T22:36:09+08:00">
                2019-12-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/Blog/categories/MySQL%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">MySQL学习笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2019/12/18/mysql/server-client-communication-way/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/12/18/mysql/server-client-communication-way/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="windows上的通信方式"><a href="#windows上的通信方式" class="headerlink" title="windows上的通信方式"></a>windows上的通信方式</h1><h2 id="1-TCP-IP通信"><a href="#1-TCP-IP通信" class="headerlink" title="1. TCP/IP通信"></a>1. TCP/IP通信</h2><p>通过TCP/IP是MySQL最常用的MySQL服务器和客户端通信方式，<br>位于应用层纄应用程序要通过TCP/IP协议族通信需要为进程指<br>定一个端口号。故而，我们需要执行命令</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld -P3306</span><br></pre></td></tr></table></figure>
<p>此时客户端默认使用tcp通信</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>
<p>或直接指定host和port通过tcp连接到服务器</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -hlocalhost -P3306 -uroot -p</span><br></pre></td></tr></table></figure>
<h2 id="2-命名管道通信"><a href="#2-命名管道通信" class="headerlink" title="2. 命名管道通信"></a>2. 命名管道通信</h2><p>window用户可以用命名管道进行进程间的通信<br>启动mysql服务器端时指定通信方式</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --enable-named-pipe</span><br></pre></td></tr></table></figure>
<p>客户端需指定使用命名管道通信连接到服务器</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --protocol=pipe</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --pipe</span><br></pre></td></tr></table></figure>
<h2 id="3-共享内存通信"><a href="#3-共享内存通信" class="headerlink" title="3. 共享内存通信"></a>3. 共享内存通信</h2><p>window用户可以用共享内存进行进程间的通信（如果client和server在同一台主机上的话）<br>启动mysql服务器端时指定通信方式</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --shared-memory</span><br></pre></td></tr></table></figure>
<p>客户端需指定使用共享内存通信连接到服务器</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --protocol=memory</span><br></pre></td></tr></table></figure>
<h2 id="4-禁止TCP-IP通信"><a href="#4-禁止TCP-IP通信" class="headerlink" title="4. 禁止TCP/IP通信"></a>4. 禁止TCP/IP通信</h2><p>启动server时我们可以禁止client和server通过tcp/ip通信<br>只需指定参数–skip-networking即可，但此时需同时指定其他通信<br>方式才可成功启动server</p>
<h3 id="1-指定共享内存"><a href="#1-指定共享内存" class="headerlink" title="1.指定共享内存"></a>1.指定共享内存</h3><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --skip-networking --shared-memory</span><br></pre></td></tr></table></figure>
<p>此时客户端默认使用共享内存通信<br>故可以按以下方式连接client和server</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --protocol=memory</span><br></pre></td></tr></table></figure>
<h3 id="2-指定命名管道"><a href="#2-指定命名管道" class="headerlink" title="2.指定命名管道"></a>2.指定命名管道</h3><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --skip-networking --enable-named-pipe</span><br></pre></td></tr></table></figure>
<p>此时连接client和server需指定命名管道通信</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --protocol=pipe</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --pipe</span><br></pre></td></tr></table></figure>
<h3 id="3-同时指定共享内存和命名管道通信"><a href="#3-同时指定共享内存和命名管道通信" class="headerlink" title="3.同时指定共享内存和命名管道通信"></a>3.同时指定共享内存和命名管道通信</h3><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --skip-networking --enable-named-pipe --shared-memory</span><br></pre></td></tr></table></figure>
<p>此时默认为共享内存通信</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>
<p>或可指定共享内存通信</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --protocol=memory</span><br></pre></td></tr></table></figure>
<p>或可指定命名管道通信</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --protocol=pipe</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p --pipe</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Blog/2019/11/24/java/java-swap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hsj">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Blog/uploads/heibai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HSJ_BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Blog/2019/11/24/java/java-swap/" itemprop="url">如何用java来交换两个数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-24T20:24:46+08:00">
                2019-11-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Blog/2019/11/24/java/java-swap/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/11/24/java/java-swap/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/Blog/page/2/">2</a><a class="extend next" rel="next" href="/Blog/page/2/">&lt;i class=&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/Blog/uploads/heibai.jpg"
                alt="hsj" />
            
              <p class="site-author-name" itemprop="name">hsj</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/Blog/archives">
              
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/Blog/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/Blog/tags/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hsj</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/Blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/Blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/Blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/Blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/Blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/Blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/Blog/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/Blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/Blog/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/Blog/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/Blog/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/Blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://https-huangsenjie-github-io-blog.disqus.com/count.js" async></script>
    

    

  




	





  














  





  

  

  

  
  

  

  

  

</body>
</html>
